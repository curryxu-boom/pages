(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{1392:function(s,a,e){"use strict";e.r(a);var n=e(1),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("img",{attrs:{src:e(736)}}),s._v(" "),n("p",[s._v("说明：下面的配置是我在本地起了两个虚拟机 169.254.182.30（master）169.254.182.40（slave）")]),s._v(" "),n("blockquote",[n("p",[s._v("注意需要先安装好redis服务 "),n("RouterLink",{attrs:{to:"/cache/redis/install/"}},[s._v("redis安装->基础安装")])],1)]),s._v(" "),n("h2",{attrs:{id:"配置-master-服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-master-服务器"}},[s._v("#")]),s._v(" 配置 master 服务器")]),s._v(" "),n("p",[s._v("① 创建 8001 文件夹")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" redis-zc\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" redis-zc\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 8001 master 服务器的端口")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("② 复制并修改 redis.conf")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制 redis.conf 文件到 8001")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/redis/etc/redis.conf /usr/local/redis-zc/8001\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改 8001 的 redis.conf 文件如下")]),s._v("\ndaemonize "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后台启动")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许外部的所有机器都能访问")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("③ 启动redis服务器")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 8001 主服务器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/redis/bin\n./redis-server /usr/local/redis-zc/8001/redis.conf \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("④ 登录客户端查看信息")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("./redis-cli "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v("\ninfo "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看信息")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("img",{attrs:{src:e(737)}}),s._v(" "),n("h2",{attrs:{id:"配置-slave-服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-slave-服务器"}},[s._v("#")]),s._v(" 配置 slave 服务器")]),s._v(" "),n("p",[s._v("① 创建 8001 文件夹")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" redis-zc\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" redis-zc\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 8001 master 服务器的端口")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("② 复制并修改 redis.conf")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制 redis.conf 文件到 8001")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/redis/etc/redis.conf /usr/local/redis-zc/8001\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改 8001 的 redis.conf 文件如下")]),s._v("\ndaemonize "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后台启动")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许外部的所有机器都能访问")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置master 服务器的ip和端口，若没有这个关键字，自行添加")]),s._v("\nslaveof 主服务器的IP地址  主服务器的端口\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("③ 启动redis服务器")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 8001 主服务器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/redis/bin\n./redis-server /usr/local/redis-zc/8001/redis.conf \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("④ 登录客户端查看信息")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("./redis-cli "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v("\ninfo "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看信息")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("img",{attrs:{src:e(738)}}),s._v(" "),n("p",[s._v("由上图可见，当前服务器为从服务器，并且连接上了主服务器")]),s._v(" "),n("p",[s._v("登录主服务器客户端，查看info信息")]),s._v(" "),n("img",{attrs:{src:e(739)}}),s._v(" "),n("p",[s._v("可以看见，主服务器已经连接上从服务器")]),s._v(" "),n("h2",{attrs:{id:"测试主写从读"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试主写从读"}},[s._v("#")]),s._v(" 测试主写从读")]),s._v(" "),n("p",[s._v("① 在主服务器插入一条数据")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录master客户端")]),s._v("\n./redis-cli "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("② 在从服务器看能否查出来")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("./redis-cli "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v("\nget "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("blockquote",[n("p",[n("strong",[s._v("主服务器的读，是通过路由到从服务器读出来的")])])]),s._v(" "),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[n("strong",[s._v("注意：")]),s._v("\n如果主服务器死了那么当前主从就会宕机-单点问题\n为了解决单点问题，redis 2.0 引入了哨兵模式")])])])}),[],!1,null,null,null);a.default=t.exports},736:function(s,a,e){s.exports=e.p+"assets/img/1594608594821.3953dbb5.png"},737:function(s,a,e){s.exports=e.p+"assets/img/img.0ea567c1.png"},738:function(s,a,e){s.exports=e.p+"assets/img/img_1.347c2d69.png"},739:function(s,a,e){s.exports=e.p+"assets/img/img_2.067312a6.png"}}]);