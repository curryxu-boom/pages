(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1033:function(t,e,_){"use strict";_.r(e);var r=_(1),s=Object(r.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("p",[t._v("压力测试考察当前软硬件环境下系统所能承受的最大负荷并帮助找出系统瓶颈所在。压测都 是为了系统在线上的处理能力和稳定性维持在一个标准范围内，做到心中有数。")]),t._v(" "),r("p",[t._v("使用压力测试，我们有希望找到很多种用其他测试方法更难发现的错误。有两种错误类型是: "),r("strong",[t._v("内存泄漏")]),t._v("，"),r("strong",[t._v("并发与同步")]),t._v("。")]),t._v(" "),r("p",[t._v("有效的压力测试系统将应用以下这些关键条件:"),r("strong",[t._v("重复，并发，量级，随机变化")]),t._v("。")]),t._v(" "),r("h2",{attrs:{id:"_1、性能指标"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1、性能指标"}},[t._v("#")]),t._v(" 1、性能指标")]),t._v(" "),r("ul",[r("li",[t._v("响应时间（Response Time: RT）\n"),r("ul",[r("li",[t._v("响应时间指用户从客户端发起一个请求开始，到客户端接收到从服务器端返回的响应结束，整个过程所耗费的时间。")])])]),t._v(" "),r("li",[t._v("HPS（Hits Per Second） ：每秒点击次数，单位是次/秒")]),t._v(" "),r("li",[t._v("TPS（Transaction per Second）：系统每秒处理交易数，单位是笔/秒。")]),t._v(" "),r("li",[t._v("QPS（Query per Second）：系统每秒处理查询次数，单位是次/秒。\n"),r("ul",[r("li",[t._v("对于互联网业务中，如果某些业务有且仅有一个请求连接，那么 TPS=QPS=HPS，一 般情况下用 TPS 来衡量整个业务流程，用 QPS 来衡量接口查询次数，用 HPS 来表 示对服务器单击请求。")])])]),t._v(" "),r("li",[t._v("无论 TPS、QPS、HPS,此指标是衡量系统处理能力非常重要的指标，越大越好，根据经 验，一般情况下：\n"),r("ul",[r("li",[t._v("金融行业：1000TPS~50000TPS，不包括互联网化的活动")]),t._v(" "),r("li",[t._v("保险行业：100TPS~100000TPS，不包括互联网化的活动")]),t._v(" "),r("li",[t._v("制造行业：10TPS~5000TPS")]),t._v(" "),r("li",[t._v("互联网电子商务：10000TPS~1000000TPS")]),t._v(" "),r("li",[t._v("互联网中型网站：1000TPS~50000TPS")]),t._v(" "),r("li",[t._v("互联网小型网站：500TPS~10000TPS")])])]),t._v(" "),r("li",[t._v("最大响应时间（Max Response Time） 指用户发出请求或者指令到系统做出反应（响应） 的最大时间。")]),t._v(" "),r("li",[t._v("最少响应时间（Mininum ResponseTime） 指用户发出请求或者指令到系统做出反应（响 应）的最少时间。")]),t._v(" "),r("li",[t._v("90%响应时间（90% Response Time） 是指所有用户的响应时间进行排序，第 90%的应时间。")]),t._v(" "),r("li",[t._v("从外部看，性能测试主要关注如下三个指标\n"),r("ul",[r("li",[t._v("吞吐量：每秒钟系统能够处理的请求数、任务数。")]),t._v(" "),r("li",[t._v("响应时间：服务处理一个请求或一个任务的耗时。")]),t._v(" "),r("li",[t._v("错误率：一批请求中结果出错的请求所占比例。")])])])]),t._v(" "),r("h2",{attrs:{id:"_2、jmeter"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2、jmeter"}},[t._v("#")]),t._v(" 2、JMeter")]),t._v(" "),r("h3",{attrs:{id:"_2-1-jmeter-安装"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-jmeter-安装"}},[t._v("#")]),t._v(" 2.1 JMeter 安装")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://jmeter.apache.org/download_jmeter.cgi",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache JMeter - Download Apache JMeter"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("下载对应的压缩包，解压运行 jmeter.bat 即可")]),t._v(" "),r("h3",{attrs:{id:"_2-2-jmeter-压测示例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-jmeter-压测示例"}},[t._v("#")]),t._v(" 2.2 JMeter 压测示例")]),t._v(" "),r("h4",{attrs:{id:"_2-2-1-添加线程组"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-添加线程组"}},[t._v("#")]),t._v(" 2.2.1 添加线程组")]),t._v(" "),r("img",{attrs:{src:_(502)}}),t._v(" "),r("img",{attrs:{src:_(503)}}),t._v(" "),r("p",[r("strong",[t._v("线程组参数详解：")])]),t._v(" "),r("ul",[r("li",[r("strong",[t._v("线程数")]),t._v("：虚拟用户数。一个虚拟用户占用一个进程或线程。设置多少虚拟用户数在这里 也就是设置多少个线程数")]),t._v(" "),r("li",[r("strong",[t._v("Ramp-Up Period(in seconds)准备时长")]),t._v("：设置的虚拟用户数需要多长时间全部启动。如果 线程数为 10，准备时长为 2，那么需要 2 秒钟启动 10 个线程，也就是每秒钟启动 5 个 线程")]),t._v(" "),r("li",[r("strong",[t._v("循环次数")]),t._v("：每个线程发送请求的次数。如果线程数为 10，循环次数为 100，那么每个线 程发送 100 次请求。总请求数为 10*100=1000 。如果勾选了“永远”，那么所有线程会 一直发送请求，一到选择停止运行脚本")]),t._v(" "),r("li",[r("strong",[t._v("Delay Thread creation until needed")]),t._v("：直到需要时延迟线程的创建")]),t._v(" "),r("li",[r("strong",[t._v("调度器")]),t._v("：设置线程组启动的开始时间和结束时间(配置调度器时，需要勾选循环次数为 永远)")]),t._v(" "),r("li",[r("strong",[t._v("持续时间（秒）")]),t._v("：测试持续时间，会覆盖结束时间")]),t._v(" "),r("li",[r("strong",[t._v("启动延迟（秒）")]),t._v("：测试延迟启动时间，会覆盖启动时间")]),t._v(" "),r("li",[r("strong",[t._v("启动时间")]),t._v("：测试启动时间，启动延迟会覆盖它。当启动时间已过，手动只需测试时当前 时间也会覆盖它")]),t._v(" "),r("li",[r("strong",[t._v("结束时间")]),t._v("：测试结束时间，持续时间会覆盖它")])]),t._v(" "),r("h4",{attrs:{id:"_2-2-2-添加-http-请求"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-添加-http-请求"}},[t._v("#")]),t._v(" 2.2.2 添加 HTTP 请求")]),t._v(" "),r("img",{attrs:{src:_(504)}}),t._v(" "),r("img",{attrs:{src:_(505)}}),t._v(" "),r("h4",{attrs:{id:"_2-2-3-添加监听器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-添加监听器"}},[t._v("#")]),t._v(" 2.2.3 添加监听器")]),t._v(" "),r("img",{attrs:{src:_(506)}}),t._v(" "),r("h4",{attrs:{id:"_2-2-4-启动压测-查看分析结果"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-启动压测-查看分析结果"}},[t._v("#")]),t._v(" 2.2.4 启动压测&查看分析结果")]),t._v(" "),r("img",{attrs:{src:_(507)}}),t._v(" "),r("p",[r("strong",[t._v("结果分析")])]),t._v(" "),r("ul",[r("li",[t._v("有错误率同开发确认，确定是否允许错误的发生或者错误率允许在多大的范围内；")]),t._v(" "),r("li",[t._v("Throughput 吞吐量每秒请求的数大于并发数，则可以慢慢的往上面增加；若在压测的机 器性能很好的情况下，出现吞吐量小于并发数，说明并发数不能再增加了，可以慢慢的 往下减，找到最佳的并发数；")]),t._v(" "),r("li",[t._v("压测结束，登陆相应的 web 服务器查看 CPU 等性能指标，进行数据的分析;")]),t._v(" "),r("li",[t._v("最大的 tps，不断的增加并发数，加到 tps 达到一定值开始出现下降，那么那个值就是 最大的 tps。")]),t._v(" "),r("li",[t._v("最大的并发数：最大的并发数和最大的 tps 是不同的概率，一般不断增加并发数，达到 一个值后，服务器出现请求超时，则可认为该值为最大的并发数。")]),t._v(" "),r("li",[t._v("压测过程出现性能瓶颈，若压力机任务管理器查看到的 cpu、网络和 cpu 都正常，未到 90%以上，则可以说明服务器有问题，压力机没有问题。")]),t._v(" "),r("li",[t._v("影响性能考虑点包括\n"),r("ul",[r("li",[t._v("数据库、应用程序、中间件（tomact、Nginx）、网络和操作系统等方")])])]),t._v(" "),r("li",[t._v("首先考虑自己的应用属于 CPU 密集型还是 I")])]),t._v(" "),r("h3",{attrs:{id:"_2-3-jmeter-address-already-in-use-错误解决"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-jmeter-address-already-in-use-错误解决"}},[t._v("#")]),t._v(" 2.3 JMeter Address Already in use 错误解决")]),t._v(" "),r("p",[t._v("windows 本身提供的端口访问机制的问题。")]),t._v(" "),r("p",[t._v("Windows 提供给 TCP/IP 链接的端口为 1024-5000，并且要四分钟来循环回收他们。就导致 我们在短时间内跑大量的请求时将端口占满了。")]),t._v(" "),r("p",[t._v("1.cmd 中，用 regedit 命令打开注册表")]),t._v(" "),r("p",[t._v("2.在 "),r("code",[t._v("HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters")]),t._v(" 下")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[t._v("2.1 .右击 parameters，添加一个新的 DWORD，名字为 MaxUserPort \n\n2.2 .然后双击 MaxUserPort，输入数值数据为 65534，基数选择十进制（如果是分布式运行的话，控制机器和负载机器都需要这样操作哦）\n\n2.3. 添加一个新的 DWORD，名字为 TCPTimedWaitDelay 输入数值 30 设置端口回收时间为30秒（可选）\n")])])]),r("p",[t._v("3.修改配置完毕之后记得重启机器才会生效")]),t._v(" "),r("p",[t._v("win官方："),r("a",{attrs:{href:"https://learn.microsoft.com/zh-CN/troubleshoot/windows-client/networking/connect-tcp-greater-than-5000-error-wsaenobufs-10055",target:"_blank",rel:"noopener noreferrer"}},[t._v("错误 WSAENOBUFS (10055) - Windows Client | Microsoft Learn"),r("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=s.exports},502:function(t,e,_){t.exports=_.p+"assets/img/65.389aec35.png"},503:function(t,e,_){t.exports=_.p+"assets/img/66.a202803e.png"},504:function(t,e,_){t.exports=_.p+"assets/img/67.434b1eb5.png"},505:function(t,e,_){t.exports=_.p+"assets/img/68.a7057d8b.png"},506:function(t,e,_){t.exports=_.p+"assets/img/69.ec8a0f51.png"},507:function(t,e,_){t.exports=_.p+"assets/img/70.253107e8.png"}}]);